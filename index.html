<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4x6 Shipping Label Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .controls { background: white; border-radius: 8px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h1 { font-size: 24px; margin-bottom: 16px; color: #333; }
        .button-group { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 16px; }
        button { background: #007bff; color: white; border: none; padding: 10px 16px; border-radius: 4px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 8px; }
        button:hover { background: #0056b3; }
        button.secondary { background: #6c757d; }
        button.secondary:hover { background: #545b62; }
        button.success { background: #28a745; }
        button.success:hover { background: #218838; }
        button.danger { background: #dc3545; }
        button.danger:hover { background: #c82333; }
        button.warning { background: #fd7e14; }
        button.warning:hover { background: #e8590c; }
        button.pink { background: #e83e8c; }
        button.pink:hover { background: #d63384; }
        .label-selector { display: flex; align-items: center; gap: 12px; margin-top: 16px; padding-top: 16px; border-top: 1px solid #e0e0e0; }
        .label-selector select { padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; }
        .edit-panel { background: white; border-radius: 8px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .edit-panel h2 { font-size: 20px; margin-bottom: 16px; color: #333; }
        .edit-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; }
        .edit-field label { display: block; font-weight: 600; margin-bottom: 4px; font-size: 13px; color: #555; }
        .edit-field input { width: 100%; padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; }
        .label-preview { display: flex; justify-content: center; }
        .label { width: 4in; height: 6in; padding: 0.25in 0.3in; background: white; display: flex; flex-direction: column; position: relative; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .section { margin-bottom: 0.15in; }
        .section-title { font-size: 8pt; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 0.04in; letter-spacing: 0.3px; }
        .item-number { font-size: 18pt; font-weight: bold; line-height: 1.1; }
        .description { font-size: 14pt; line-height: 1.15; font-weight: 500; }
        .upc-text { font-size: 12pt; line-height: 1.1; font-weight: 500; }
        .info-grid { display: grid; grid-template-columns: auto 1fr; gap: 0.08in 0.2in; font-size: 12pt; line-height: 1.3; }
        .info-label { font-weight: 700; }
        .info-value { font-weight: 500; }
        .barcode-section { text-align: center; margin-top: auto; padding-top: 0.08in; }
        .barcode-container { display: flex; justify-content: center; margin-bottom: 0.06in; }
        .barcode-wrapper { border-top: 4.8px solid #000; border-bottom: 4.8px solid #000; display: inline-block; background: #fff; padding: 0 10px; }
        .barcode-number { font-size: 11pt; font-weight: 700; letter-spacing: 1.5px; }
        .hidden { display: none; }
        @page { size: 4in 6in; margin: 0; }
        @media print {
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            html, body { margin: 0 !important; padding: 0 !important; width: 4in !important; height: 6in !important; overflow: hidden !important; }
            .controls, .edit-panel { display: none !important; }
            .label-preview { display: flex !important; width: 4in !important; height: 6in !important; margin: 0 !important; padding: 0 !important; }
            .label { box-shadow: none !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="controls">
            <h1>4x6 Shipping Label Generator</h1>
            <div class="button-group">
                <button onclick="document.getElementById('fileInput').click()">üì§ Upload Excel</button>
                <button class="success" onclick="downloadTemplate()">üì• Download Template</button>
                <button class="warning" onclick="downloadHTML()">üíæ Download HTML</button>
                <button class="pink" onclick="exportToPDF()">üìÑ Export to PDF</button>
                <button class="secondary" onclick="window.print()">üñ®Ô∏è Print</button>
                <button onclick="toggleEdit()">‚úèÔ∏è <span id="editBtnText">Edit</span></button>
                <button class="success" onclick="addLabel()">‚ûï Add</button>
                <button class="danger" onclick="deleteLabel()" id="deleteBtn">üóëÔ∏è Delete</button>
            </div>
            <input type="file" id="fileInput" accept=".xlsx,.xls" class="hidden" onchange="handleExcelUpload(event)">
            <div class="label-selector">
                <strong>Label:</strong>
                <select id="labelSelect" onchange="changeLabel(this.value)"></select>
                <span id="labelCount"></span>
            </div>
        </div>
        <div class="edit-panel hidden" id="editPanel">
            <h2>Edit Label Fields</h2>
            <div class="edit-grid" id="editGrid"></div>
        </div>
        <div class="label-preview">
            <div class="label">
                <div class="section">
                    <div class="section-title">Item Number</div>
                    <div class="item-number" id="itemNumber"></div>
                </div>
                <div class="section">
                    <div class="section-title">Description</div>
                    <div class="description" id="description"></div>
                </div>
                <div class="section">
                    <div class="section-title">UPC</div>
                    <div class="upc-text" id="upc"></div>
                </div>
                <div class="section">
                    <div class="info-grid">
                        <span class="info-label">Case Qty:</span><span class="info-value" id="caseQty"></span>
                        <span class="info-label">Inner Qty:</span><span class="info-value" id="innerQty"></span>
                        <span class="info-label">Net Weight:</span><span class="info-value" id="netWeight"></span>
                        <span class="info-label">Gross Weight:</span><span class="info-value" id="grossWeight"></span>
                        <span class="info-label">Dimensions:</span><span class="info-value" id="dimensions"></span>
                        <span class="info-label">CBM:</span><span class="info-value" id="cbm"></span>
                        <span class="info-label">Vendor ID:</span><span class="info-value" id="vendorId"></span>
                        <span class="info-label">Made in:</span><span class="info-value" id="madeIn"></span>
                    </div>
                </div>
                <div class="barcode-section">
                    <div class="barcode-container">
                        <div class="barcode-wrapper"><svg id="barcode"></svg></div>
                    </div>
                    <div class="barcode-number" id="barcodeNumber"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
        let labels = [{itemNumber:'SL-CC002-437Q',description:'32 Oz CH Ceramic Hydro Coat',upc:'194383038054',caseQty:'6 pcs',innerQty:'1 pcs',netWeight:'8.93 kg',grossWeight:'8.93 kg',dimensions:'27.5 x 18.7 x 32 cm',cbm:'0.014',vendorId:'670',madeIn:'U.S.A.',barcode:'20194383042109'}];
        let currentIndex=0,editMode=false;
        function renderLabel(){const l=labels[currentIndex];document.getElementById('itemNumber').textContent=l.itemNumber;document.getElementById('description').textContent=l.description;document.getElementById('upc').textContent=l.upc;document.getElementById('caseQty').textContent=l.caseQty;document.getElementById('innerQty').textContent=l.innerQty;document.getElementById('netWeight').textContent=l.netWeight;document.getElementById('grossWeight').textContent=l.grossWeight;document.getElementById('dimensions').textContent=l.dimensions;document.getElementById('cbm').textContent=l.cbm;document.getElementById('vendorId').textContent=l.vendorId;document.getElementById('madeIn').textContent=l.madeIn;document.getElementById('barcodeNumber').textContent=l.barcode;if(window.JsBarcode){try{JsBarcode("#barcode",l.barcode,{format:"ITF14",width:2,height:50,displayValue:false,margin:0,background:"#fff",lineColor:"#000"})}catch(e){console.error(e)}}updateSelector();if(editMode)renderEditPanel()}
        function updateSelector(){const s=document.getElementById('labelSelect');s.innerHTML='';labels.forEach((_,i)=>{const o=document.createElement('option');o.value=i;o.textContent=`Label ${i+1}`;o.selected=i===currentIndex;s.appendChild(o)});document.getElementById('labelCount').textContent=`of ${labels.length}`;document.getElementById('deleteBtn').style.display=labels.length>1?'flex':'none'}
        function changeLabel(i){currentIndex=parseInt(i);renderLabel()}
        function toggleEdit(){editMode=!editMode;document.getElementById('editPanel').classList.toggle('hidden');document.getElementById('editBtnText').textContent=editMode?'View':'Edit';if(editMode)renderEditPanel()}
        function renderEditPanel(){const g=document.getElementById('editGrid');g.innerHTML='';const l=labels[currentIndex];Object.keys(l).forEach(k=>{const f=document.createElement('div');f.className='edit-field';f.innerHTML=`<label>${k.replace(/([A-Z])/g,' $1').trim()}</label><input type="text" value="${l[k]}" onchange="updateField('${k}',this.value)">`;g.appendChild(f)})}
        function updateField(f,v){labels[currentIndex][f]=v;renderLabel()}
        function addLabel(){labels.push({...labels[currentIndex]});currentIndex=labels.length-1;renderLabel()}
        function deleteLabel(){if(labels.length===1)return;labels.splice(currentIndex,1);currentIndex=Math.max(0,currentIndex-1);renderLabel()}
        function handleExcelUpload(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{const d=new Uint8Array(e.target.result);const w=XLSX.read(d,{type:'array'});const s=w.Sheets[w.SheetNames[0]];const j=XLSX.utils.sheet_to_json(s);labels=j.map(r=>({itemNumber:r['Item Number']||r.itemNumber||'',description:r.Description||r.description||'',upc:r.UPC||r.upc||'',caseQty:r['Case Qty']||r.caseQty||'',innerQty:r['Inner Qty']||r.innerQty||'',netWeight:r['Net Weight']||r.netWeight||'',grossWeight:r['Gross Weight']||r.grossWeight||'',dimensions:r.Dimensions||r.dimensions||'',cbm:r.CBM||r.cbm||'',vendorId:r['Vendor ID']||r.vendorId||'',madeIn:r['Made in']||r.madeIn||'',barcode:r.Barcode||r.barcode||''}));currentIndex=0;renderLabel()};r.readAsArrayBuffer(f)}
        function downloadTemplate(){const t=[{'Item Number':'SL-CC002-437Q',Description:'32 Oz CH Ceramic Hydro Coat',UPC:'194383038054','Case Qty':'6 pcs','Inner Qty':'1 pcs','Net Weight':'8.93 kg','Gross Weight':'8.93 kg',Dimensions:'27.5 x 18.7 x 32 cm',CBM:'0.014','Vendor ID':'670','Made in':'U.S.A.',Barcode:'20194383042109'}];const w=XLSX.utils.json_to_sheet(t);const b=XLSX.utils.book_new();XLSX.utils.book_append_sheet(b,w,'Labels');XLSX.writeFile(b,'shipping_label_template.xlsx')}
        function downloadHTML(){const l=labels[currentIndex];const h=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Label</title><script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script><style>*{margin:0;padding:0;box-sizing:border-box}@page{size:4in 6in;margin:0}html,body{width:4in;height:6in;overflow:hidden}body{font-family:Arial,sans-serif;background:#f0f0f0}.label{width:4in;height:6in;padding:.25in .3in;background:#fff;display:flex;flex-direction:column;position:relative}.section{margin-bottom:.15in}.section-title{font-size:8pt;font-weight:bold;color:#666;text-transform:uppercase;margin-bottom:.04in;letter-spacing:.3px}.item-number{font-size:18pt;font-weight:bold;line-height:1.1}.description{font-size:14pt;line-height:1.15;font-weight:500}.upc-text{font-size:12pt;line-height:1.1;font-weight:500}.info-grid{display:grid;grid-template-columns:auto 1fr;gap:.08in .2in;font-size:12pt;line-height:1.3}.info-label{font-weight:700}.info-value{font-weight:500}.barcode-section{text-align:center;margin-top:auto;padding-top:.08in}.barcode-container{display:flex;justify-content:center;margin-bottom:.06in}.barcode-wrapper{border-top:4.8px solid #000;border-bottom:4.8px solid #000;display:inline-block;background:#fff;padding:0 10px}.barcode-number{font-size:11pt;font-weight:700;letter-spacing:1.5px}@media print{html,body{width:4in!important;height:6in!important}}</style></head><body><div class="label"><div class="section"><div class="section-title">Item Number</div><div class="item-number">${l.itemNumber}</div></div><div class="section"><div class="section-title">Description</div><div class="description">${l.description}</div></div><div class="section"><div class="section-title">UPC</div><div class="upc-text">${l.upc}</div></div><div class="section"><div class="info-grid"><span class="info-label">Case Qty:</span><span class="info-value">${l.caseQty}</span><span class="info-label">Inner Qty:</span><span class="info-value">${l.innerQty}</span><span class="info-label">Net Weight:</span><span class="info-value">${l.netWeight}</span><span class="info-label">Gross Weight:</span><span class="info-value">${l.grossWeight}</span><span class="info-label">Dimensions:</span><span class="info-value">${l.dimensions}</span><span class="info-label">CBM:</span><span class="info-value">${l.cbm}</span><span class="info-label">Vendor ID:</span><span class="info-value">${l.vendorId}</span><span class="info-label">Made in:</span><span class="info-value">${l.madeIn}</span></div></div><div class="barcode-section"><div class="barcode-container"><div class="barcode-wrapper"><svg id="barcode"></svg></div></div><div class="barcode-number">${l.barcode}</div></div></div><script>window.onload=()=>{if(window.JsBarcode)JsBarcode("#barcode","${l.barcode}",{format:"ITF14",width:2,height:50,displayValue:false,margin:0,background:"#fff",lineColor:"#000"})}</script></body></html>`;const b=new Blob([h],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=`label_${l.itemNumber}.html`;a.click();URL.revokeObjectURL(u)}
        function exportToPDF(){alert('To export as PDF:\n\n1. Click "Download HTML"\n2. Open HTML file in browser\n3. Press Ctrl+P (Cmd+P on Mac)\n4. Choose "Save as PDF"\n5. Set paper size to 4x6 inches\n6. Set scale to "Actual size" (100%)\n7. Set margins to "None"\n8. Save')}
        window.onload=()=>renderLabel();
    </script>
</body>
</html>